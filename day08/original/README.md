My first attempt. It works, but not too elegant.
